- name: install nginx server  
  ansible.builtin.dnf:
    name: nginx 
    state: installed 
    

- name: start the nginx server 
  ansible.builtin.service: 
    name: nginx 
    state: started
    enabled: yes


- name: remove the default content 
  ansible.builtin.file:
    path: /usr/share/nginx/html
    state: absent
  
- name: create html directory 
  ansible.builtin.file: 
    path: /usr/share/nginx/html 
    state: directory 

- name: download and unzip the  code 
  ansible.builtin.unarchive:
    src: https://expense-builds.s3.us-east-1.amazonaws.com/expense-frontend-v2.zip
    dest: /usr/share/nginx/html
    remote_src: yes  

- name: copy backend conf 
  ansible.builtin.templates:
    src: expense.conf.j2 
    dest: /etc/systemd/system/expense.conf

- name: restart nginx 
  ansible.builtin.service:
    name: nginx 
    state: restarted 
